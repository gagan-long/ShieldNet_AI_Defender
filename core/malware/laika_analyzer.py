from laikaboss.object import Object
from laikaboss.si_module import SI_MODULE

class MalwareAnalyzer(SI_MODULE):
    def handle_scan(self, scanObject, result, depth, args):
        # Custom YARA rule check
        if "powershell_malware" in scanObject.yaraMatches:
            scanObject.addFlag("malicious_powershell")
        
        # File entropy analysis
        if scanObject.entropy > 7.5:
            scanObject.addFlag("high_entropy")
        
        return scanObject
